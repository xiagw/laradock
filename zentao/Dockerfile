
# ARG ZT_VERSION=latest
ARG ZT_VERSION=21.7.7
FROM hub.zentao.net/app/zentao:${ZT_VERSION}
LABEL maintainer="xiagw <fxiaxiaoyu@gmail.com>"

ARG ZT_VERSION=${ZT_VERSION}
ARG ZT_MYSQL_HOST=${ZT_MYSQL_HOST}
ARG ZT_MYSQL_PORT=${ZT_MYSQL_PORT}
ARG ZT_MYSQL_USER=${ZT_MYSQL_USER}
ARG ZT_MYSQL_PASSWORD=${ZT_MYSQL_PASSWORD}
ARG ZT_MYSQL_DB=${ZT_MYSQL_DB}
ARG ZT_APP_DOMAIN=${ZT_APP_DOMAIN}

ENV ZT_VERSION=${ZT_VERSION}
ENV ZT_MYSQL_HOST=${ZT_MYSQL_HOST}
ENV ZT_MYSQL_PORT=${ZT_MYSQL_PORT}
ENV ZT_MYSQL_USER=${ZT_MYSQL_USER}
ENV ZT_MYSQL_PASSWORD=${ZT_MYSQL_PASSWORD}
ENV ZT_MYSQL_DB=${ZT_MYSQL_DB}
ENV APP_DOMAIN=${ZT_APP_DOMAIN}
ENV PHP_MAX_EXECUTION_TIME=120
ENV PHP_MEMORY_LIMIT=512M
ENV PHP_POST_MAX_SIZE=1024M
ENV PHP_UPLOAD_MAX_FILESIZE=1024M
ENV LDAP_ENABLED=false
ENV SMTP_ENABLED=false
ENV APP_DEFAULT_PORT=80
ENV PROTOCOL_TYPE=http
ENV IS_CONTAINER=true
ENV LINK_GIT=false
ENV LINK_CI=false

COPY root/ /
RUN sed -i "/template.*estimate/s/=.*/= '8';/" /apps/zentao/module/task/config.php


